2025-07-20T00:30:29.6748325Z ##[group]Run pnpm test || (echo "Tests failed. Running individual package tests..." && pnpm -r test)
2025-07-20T00:30:29.6749394Z [36;1mpnpm test || (echo "Tests failed. Running individual package tests..." && pnpm -r test)[0m
2025-07-20T00:30:29.6777892Z shell: /usr/bin/bash -e {0}
2025-07-20T00:30:29.6778121Z env:
2025-07-20T00:30:29.6778279Z   REGISTRY: ghcr.io
2025-07-20T00:30:29.6778484Z   IMAGE_NAME: patrg444/Cygni
2025-07-20T00:30:29.6778875Z   PNPM_HOME: /home/runner/setup-pnpm/node_modules/.bin
2025-07-20T00:30:29.6779186Z ##[endgroup]
2025-07-20T00:30:30.0907545Z 
2025-07-20T00:30:30.0908443Z > cloudexpress@0.1.0 test /home/runner/work/Cygni/Cygni
2025-07-20T00:30:30.0909334Z > npx turbo run test
2025-07-20T00:30:30.0909512Z 
2025-07-20T00:30:30.4468780Z 
2025-07-20T00:30:30.4469239Z Attention:
2025-07-20T00:30:30.4470040Z Turborepo now collects completely anonymous telemetry regarding usage.
2025-07-20T00:30:30.4470912Z This information is used to shape the Turborepo roadmap and prioritize features.
2025-07-20T00:30:30.4471865Z You can learn more, including how to opt-out if you'd not like to participate in this anonymous program, by visiting the following URL:
2025-07-20T00:30:30.4472476Z https://turbo.build/repo/docs/telemetry
2025-07-20T00:30:30.4472686Z 
2025-07-20T00:30:30.5057559Z • Packages in scope: @cloudexpress/api, @cloudexpress/auth, @cloudexpress/builder, @cloudexpress/services-api, @cloudexpress/web-ui, @cygni/cli, @cygni/sdk, cygni-nextjs-starter
2025-07-20T00:30:30.5059963Z • Running test in 8 packages
2025-07-20T00:30:30.5060519Z • Remote caching disabled
2025-07-20T00:30:31.7012256Z ##[group]@cloudexpress/api:build
2025-07-20T00:30:31.7013004Z cache miss, executing d7d57639bfc623a5
2025-07-20T00:30:31.7013326Z 
2025-07-20T00:30:31.7013807Z > @cloudexpress/api@1.0.0 build /home/runner/work/Cygni/Cygni/packages/api
2025-07-20T00:30:31.7014823Z > echo 'Skipping build for packages/api - using services/api instead'
2025-07-20T00:30:31.7015283Z 
2025-07-20T00:30:31.7015668Z Skipping build for packages/api - using services/api instead
2025-07-20T00:30:31.7016665Z ##[endgroup]
2025-07-20T00:30:33.1781806Z ##[group]@cloudexpress/api:test
2025-07-20T00:30:33.1819820Z cache miss, executing 65717c5af65827f0
2025-07-20T00:30:33.1820270Z 
2025-07-20T00:30:33.1820773Z > @cloudexpress/api@1.0.0 test /home/runner/work/Cygni/Cygni/packages/api
2025-07-20T00:30:33.1821716Z > echo 'Skipping tests for packages/api - using services/api instead'
2025-07-20T00:30:33.1822205Z 
2025-07-20T00:30:33.1822602Z Skipping tests for packages/api - using services/api instead
2025-07-20T00:30:33.1824675Z ##[endgroup]
2025-07-20T00:30:37.9058388Z ##[group]@cloudexpress/auth:build
2025-07-20T00:30:37.9075757Z cache miss, executing b67affc02e0960ce
2025-07-20T00:30:37.9080166Z 
2025-07-20T00:30:37.9080994Z > @cloudexpress/auth@0.1.0 build /home/runner/work/Cygni/Cygni/services/auth
2025-07-20T00:30:37.9100756Z > tsc
2025-07-20T00:30:37.9101844Z 
2025-07-20T00:30:37.9109260Z ##[endgroup]
2025-07-20T00:30:38.3245702Z ##[group]@cygni/sdk:build
2025-07-20T00:30:38.3253125Z cache miss, executing 7c13eef4e550ea9c
2025-07-20T00:30:38.3253871Z 
2025-07-20T00:30:38.3254685Z > @cygni/sdk@0.1.0 build /home/runner/work/Cygni/Cygni/packages/sdk
2025-07-20T00:30:38.3255593Z > tsc
2025-07-20T00:30:38.3255960Z 
2025-07-20T00:30:38.3256609Z ##[endgroup]
2025-07-20T00:30:40.0051014Z ##[group]@cygni/cli:build
2025-07-20T00:30:40.0055856Z cache miss, executing 689109052fca61f6
2025-07-20T00:30:40.0056765Z 
2025-07-20T00:30:40.0062898Z > @cygni/cli@0.1.0 build /home/runner/work/Cygni/Cygni/packages/cli
2025-07-20T00:30:40.0063938Z > tsc && chmod +x dist/index.js
2025-07-20T00:30:40.0064389Z 
2025-07-20T00:30:40.0065366Z ##[endgroup]
2025-07-20T00:30:40.5633148Z [;31m@cloudexpress/builder:build[;0m
2025-07-20T00:30:40.5635527Z cache miss, executing 1c027b4cae1c2aa2
2025-07-20T00:30:40.5637073Z 
2025-07-20T00:30:40.5639021Z > @cloudexpress/builder@0.1.0 build /home/runner/work/Cygni/Cygni/services/builder
2025-07-20T00:30:40.5640951Z > tsc
2025-07-20T00:30:40.5643000Z 
2025-07-20T00:30:40.5673558Z ##[error]src/builder.test.ts(1,1): error TS2582: Cannot find name 'describe'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha`.
2025-07-20T00:30:40.5707793Z ##[error]src/builder.test.ts(2,3): error TS2582: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha`.
2025-07-20T00:30:40.5711378Z ##[error]src/builder.test.ts(3,5): error TS2304: Cannot find name 'expect'.
2025-07-20T00:30:40.5713825Z  ELIFECYCLE  Command failed with exit code 1.
2025-07-20T00:30:40.5715805Z [ERROR] command finished with error: command (/home/runner/work/Cygni/Cygni/services/builder) /home/runner/setup-pnpm/node_modules/.bin/pnpm run build exited (1)
2025-07-20T00:30:40.5717589Z ##[group]@cygni/cli:test
2025-07-20T00:30:40.5718333Z cache miss, executing 6a6cb53b13f7887a
2025-07-20T00:30:40.5719440Z ##[endgroup]
2025-07-20T00:30:40.5944361Z ##[group]@cygni/sdk:test
2025-07-20T00:30:40.5950338Z cache miss, executing 70edf3f992f51596
2025-07-20T00:30:40.5950728Z 
2025-07-20T00:30:40.5951137Z > @cygni/sdk@0.1.0 test /home/runner/work/Cygni/Cygni/packages/sdk
2025-07-20T00:30:40.5951690Z > jest
2025-07-20T00:30:40.5951870Z 
2025-07-20T00:30:40.5952310Z ##[endgroup]
2025-07-20T00:30:40.5988132Z ##[group]@cloudexpress/auth:test
2025-07-20T00:30:40.5990140Z cache miss, executing efa40a2d72fc604b
2025-07-20T00:30:40.5990502Z 
2025-07-20T00:30:40.5991008Z > @cloudexpress/auth@0.1.0 test /home/runner/work/Cygni/Cygni/services/auth
2025-07-20T00:30:40.5991620Z > vitest
2025-07-20T00:30:40.5991790Z 
2025-07-20T00:30:40.5992200Z ##[endgroup]
2025-07-20T00:30:40.6069742Z ##[group]@cloudexpress/services-api:build
2025-07-20T00:30:40.6072372Z cache miss, executing 0df342134276763b
2025-07-20T00:30:40.6072797Z 
2025-07-20T00:30:40.6073359Z > @cloudexpress/services-api@0.1.0 build /home/runner/work/Cygni/Cygni/services/api
2025-07-20T00:30:40.6074117Z > tsc
2025-07-20T00:30:40.6074294Z 
2025-07-20T00:30:40.6074709Z ##[endgroup]
2025-07-20T00:30:40.6263826Z ##[group]@cloudexpress/web-ui:build
2025-07-20T00:30:40.6265825Z cache miss, executing 228955e8942f1de9
2025-07-20T00:30:40.6266252Z 
2025-07-20T00:30:40.6266804Z > @cloudexpress/web-ui@0.1.0 build /home/runner/work/Cygni/Cygni/packages/web-ui
2025-07-20T00:30:40.6267438Z > next build
2025-07-20T00:30:40.6267634Z 
2025-07-20T00:30:40.6268208Z  ⚠ Invalid next.config.js options detected: 
2025-07-20T00:30:40.6269396Z  ⚠     Unrecognized key(s) in object: 'serverActions' at "experimental"
2025-07-20T00:30:40.6270470Z  ⚠ See more info here: https://nextjs.org/docs/messages/invalid-next-config
2025-07-20T00:30:40.6271753Z  ⚠ Server Actions are available by default now, `experimental.serverActions` option can be safely removed.
2025-07-20T00:30:40.6273531Z ⚠ No build cache found. Please configure build caching for faster rebuilds. Read more: https://nextjs.org/docs/messages/no-cache
2025-07-20T00:30:40.6275227Z Attention: Next.js now collects completely anonymous telemetry regarding usage.
2025-07-20T00:30:40.6276244Z This information is used to shape Next.js' roadmap and prioritize features.
2025-07-20T00:30:40.6277550Z You can learn more, including how to opt-out if you'd not like to participate in this anonymous program, by visiting the following URL:
2025-07-20T00:30:40.6278534Z https://nextjs.org/telemetry
2025-07-20T00:30:40.6279194Z 
2025-07-20T00:30:40.6279468Z    ▲ Next.js 14.0.0
2025-07-20T00:30:40.6279704Z 
2025-07-20T00:30:40.6279963Z    Creating an optimized production build ...
2025-07-20T00:30:40.6280729Z ##[endgroup]
2025-07-20T00:30:40.9192415Z ##[group]cygni-nextjs-starter:build
2025-07-20T00:30:40.9192943Z cache miss, executing 574eded4be020d8b
2025-07-20T00:30:40.9193129Z 
2025-07-20T00:30:40.9193620Z > cygni-nextjs-starter@0.1.0 build /home/runner/work/Cygni/Cygni/examples/nextjs-starter
2025-07-20T00:30:40.9194265Z > next build
2025-07-20T00:30:40.9194391Z 
2025-07-20T00:30:40.9195078Z ##[endgroup]
2025-07-20T00:30:40.9207687Z ##[error]@cloudexpress/builder#build: command (/home/runner/work/Cygni/Cygni/services/builder) /home/runner/setup-pnpm/node_modules/.bin/pnpm run build exited (1)
2025-07-20T00:30:40.9214468Z 
2025-07-20T00:30:40.9214676Z  Tasks:    5 successful, 12 total
2025-07-20T00:30:40.9214965Z Cached:    0 cached, 12 total
2025-07-20T00:30:40.9215205Z   Time:    10.468s 
2025-07-20T00:30:40.9215479Z Failed:    @cloudexpress/builder#build
2025-07-20T00:30:40.9215659Z 
2025-07-20T00:30:40.9259918Z  ERROR  run failed: command  exited (1)
2025-07-20T00:30:41.1133641Z  ELIFECYCLE  Test failed. See above for more details.
2025-07-20T00:30:41.1333202Z Tests failed. Running individual package tests...
2025-07-20T00:30:41.5831563Z Scope: 8 of 9 workspace projects
2025-07-20T00:30:41.5920321Z packages/api test$ echo 'Skipping tests for packages/api - using services/api instead'
2025-07-20T00:30:41.5921546Z packages/cli test$ vitest
2025-07-20T00:30:41.5922110Z packages/sdk test$ jest
2025-07-20T00:30:41.5931981Z services/api test$ vitest
2025-07-20T00:30:41.6169797Z packages/api test: Skipping tests for packages/api - using services/api instead
2025-07-20T00:30:41.6198537Z packages/api test: Done
2025-07-20T00:30:41.6210956Z services/auth test$ vitest
2025-07-20T00:30:42.1818081Z packages/cli test: [33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
2025-07-20T00:30:42.1998290Z services/api test: [7m[1m[36m RUN [39m[22m[27m [36mv0.34.6[39m [90m/home/runner/work/Cygni/Cygni/services/api[39m
2025-07-20T00:30:42.2380498Z packages/cli test: [7m[1m[36m RUN [39m[22m[27m [36mv0.34.6[39m [90m/home/runner/work/Cygni/Cygni/packages/cli[39m
2025-07-20T00:30:42.2633515Z services/auth test: [7m[1m[36m RUN [39m[22m[27m [36mv0.34.6[39m [90m/home/runner/work/Cygni/Cygni/services/auth[39m
2025-07-20T00:30:43.2061727Z services/api test:  [32m✓[39m src/health.test.ts [2m ([22m[2m1 test[22m[2m)[22m[90m 9[2mms[22m[39m
2025-07-20T00:30:43.2444705Z services/auth test:  [32m✓[39m src/auth.test.ts [2m ([22m[2m1 test[22m[2m)[22m[90m 14[2mms[22m[39m
2025-07-20T00:30:43.2446545Z services/api test: [2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
2025-07-20T00:30:43.2447907Z services/api test: [2m      Tests [22m [1m[32m1 passed[39m[22m[90m (1)[39m
2025-07-20T00:30:43.2449232Z services/api test: [2m   Start at [22m 00:30:42
2025-07-20T00:30:43.2450965Z services/api test: [2m   Duration [22m 1.04s[2m (transform 153ms, setup 1ms, collect 83ms, tests 9ms, environment 0ms, prepare 250ms)[22m
2025-07-20T00:30:43.2727757Z services/auth test: [2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
2025-07-20T00:30:43.2735458Z services/auth test: [2m      Tests [22m [1m[32m1 passed[39m[22m[90m (1)[39m
2025-07-20T00:30:43.2742314Z services/auth test: [2m   Start at [22m 00:30:42
2025-07-20T00:30:43.2763211Z services/auth test: [2m   Duration [22m 1.01s[2m (transform 72ms, setup 0ms, collect 68ms, tests 14ms, environment 0ms, prepare 164ms)[22m
2025-07-20T00:30:43.3145832Z services/auth test: Done
2025-07-20T00:30:43.3166623Z services/api test: Done
2025-07-20T00:30:43.3176630Z services/builder test$ vitest
2025-07-20T00:30:43.4466329Z packages/cli test:  [32m✓[39m src/tests/framework-detector.test.ts [2m ([22m[2m12 tests[22m[2m)[22m[90m 25[2mms[22m[39m
2025-07-20T00:30:43.4982843Z packages/cli test: [90mstdout[2m | src/tests/builder.test.ts[2m > [22m[2mBuilder[2m > [22m[2mbuildProject[2m > [22m[2mshould auto-detect framework when not specified[22m[39m
2025-07-20T00:30:43.4987188Z packages/cli test: Detected framework: react
2025-07-20T00:30:43.4991337Z packages/cli test: [90mstdout[2m | src/tests/builder.test.ts[2m > [22m[2mBuilder[2m > [22m[2mbuildProject[2m > [22m[2mshould run pre-build commands when specified[22m[39m
2025-07-20T00:30:43.5009600Z packages/cli test: Running build command...
2025-07-20T00:30:43.5012210Z packages/cli test:  [32m✓[39m src/tests/builder.test.ts [2m ([22m[2m7 tests[22m[2m)[22m[90m 24[2mms[22m[39m
2025-07-20T00:30:43.6525766Z packages/sdk test: PASS src/sdk.test.ts
2025-07-20T00:30:43.6598437Z packages/sdk test:   SDK
2025-07-20T00:30:43.6603520Z packages/sdk test:     ✓ should pass basic test (6 ms)
2025-07-20T00:30:43.6654331Z packages/sdk test: Test Suites: 1 passed, 1 total
2025-07-20T00:30:43.6659381Z packages/sdk test: Tests:       1 passed, 1 total
2025-07-20T00:30:43.6663670Z packages/sdk test: Snapshots:   0 total
2025-07-20T00:30:43.6667542Z packages/sdk test: Time:        1.093 s
2025-07-20T00:30:43.6671676Z packages/sdk test: Ran all test suites.
2025-07-20T00:30:43.8028368Z packages/sdk test: Done
2025-07-20T00:30:43.8926349Z packages/cli test:  [33m❯[39m src/tests/deploy-helpers.test.ts [2m ([22m[2m18 tests[22m [2m|[22m [31m1 failed[39m[2m)[22m[90m 84[2mms[22m[39m
2025-07-20T00:30:43.8929486Z packages/cli test: [31m   [33m❯[31m src/tests/deploy-helpers.test.ts[2m > [22mDeploy Helpers[2m > [22mcheckBuildCache[2m > [22mshould calculate dockerfile hash when provided[39m
2025-07-20T00:30:43.8931893Z packages/cli test: [31m     → expected "spy" to be called with arguments: [ '/builds/cache', …(1) ]
2025-07-20T00:30:43.8932862Z packages/cli test: Received: 
2025-07-20T00:30:43.8933616Z packages/cli test: Number of calls: 0
2025-07-20T00:30:43.8934267Z packages/cli test: [39m
2025-07-20T00:30:43.9531704Z packages/cli test:  [32m✓[39m src/dummy.test.ts [2m ([22m[2m1 test[22m[2m)[22m[90m 4[2mms[22m[39m
2025-07-20T00:30:43.9660978Z packages/cli test: [31m⎯⎯⎯⎯⎯⎯⎯[1m[7m Failed Tests 1 [27m[22m⎯⎯⎯⎯⎯⎯⎯[39m
2025-07-20T00:30:43.9663666Z packages/cli test: [31m[1m[7m FAIL [27m[22m[39m src/tests/deploy-helpers.test.ts[2m > [22mDeploy Helpers[2m > [22mcheckBuildCache[2m > [22mshould calculate dockerfile hash when provided
2025-07-20T00:30:43.9673539Z packages/cli test: [31m[1mAssertionError[22m: expected "spy" to be called with arguments: [ '/builds/cache', …(1) ]
2025-07-20T00:30:43.9674802Z packages/cli test: Received: 
2025-07-20T00:30:43.9675741Z packages/cli test: Number of calls: 0
2025-07-20T00:30:43.9677401Z packages/cli test: [39m
2025-07-20T00:30:43.9679773Z packages/cli test: [36m [2m❯[22m src/tests/deploy-helpers.test.ts:[2m165:27[22m[39m
2025-07-20T00:30:43.9729006Z packages/cli test:     [90m163| [39m      await checkBuildCache("abc123", "Dockerfile");
2025-07-20T00:30:43.9731316Z packages/cli test:     [90m164| [39m
2025-07-20T00:30:43.9733584Z packages/cli test:     [90m165| [39m      expect(mockApi.get).toHaveBeenCalledWith("/builds/cache", {
2025-07-20T00:30:43.9735862Z packages/cli test:     [90m   | [39m                          [31m^[39m
2025-07-20T00:30:43.9737492Z packages/cli test:     [90m166| [39m        params: {
2025-07-20T00:30:43.9739126Z packages/cli test:     [90m167| [39m          gitSha: "abc123",
2025-07-20T00:30:43.9740601Z packages/cli test: [31m[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯[22m[39m
2025-07-20T00:30:43.9745052Z packages/cli test: [2m Test Files [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m3 passed[39m[22m[90m (4)[39m
2025-07-20T00:30:43.9746495Z packages/cli test: [2m      Tests [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m37 passed[39m[22m[90m (38)[39m
2025-07-20T00:30:43.9747427Z packages/cli test: [2m   Start at [22m 00:30:42
2025-07-20T00:30:43.9748941Z packages/cli test: [2m   Duration [22m 1.73s[2m (transform 403ms, setup 0ms, collect 1.08s, tests 137ms, environment 1ms, prepare 910ms)[22m
2025-07-20T00:30:43.9911345Z services/builder test: [7m[1m[36m RUN [39m[22m[27m [36mv0.34.6[39m [90m/home/runner/work/Cygni/Cygni/services/builder[39m
2025-07-20T00:30:43.9924058Z packages/cli test: Failed
2025-07-20T00:30:43.9935442Z /home/runner/work/Cygni/Cygni/packages/cli:
2025-07-20T00:30:43.9937364Z  ERR_PNPM_RECURSIVE_RUN_FIRST_FAIL  @cygni/cli@0.1.0 test: `vitest`
2025-07-20T00:30:43.9938026Z Exit status 1
2025-07-20T00:30:44.0147758Z ##[error]Process completed with exit code 1.
