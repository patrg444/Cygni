2025-07-20T00:30:26.3589317Z ##[group]Run pnpm test || (echo "Tests failed. Running individual package tests..." && pnpm -r test)
2025-07-20T00:30:26.3589964Z [36;1mpnpm test || (echo "Tests failed. Running individual package tests..." && pnpm -r test)[0m
2025-07-20T00:30:26.3617913Z shell: /usr/bin/bash -e {0}
2025-07-20T00:30:26.3618140Z env:
2025-07-20T00:30:26.3618298Z   REGISTRY: ghcr.io
2025-07-20T00:30:26.3618496Z   IMAGE_NAME: patrg444/Cygni
2025-07-20T00:30:26.3619029Z   PNPM_HOME: /home/runner/setup-pnpm/node_modules/.bin
2025-07-20T00:30:26.3619349Z ##[endgroup]
2025-07-20T00:30:26.7858851Z 
2025-07-20T00:30:26.7859798Z > cloudexpress@0.1.0 test /home/runner/work/Cygni/Cygni
2025-07-20T00:30:26.7860304Z > npx turbo run test
2025-07-20T00:30:26.7860486Z 
2025-07-20T00:30:27.1902063Z 
2025-07-20T00:30:27.1902315Z Attention:
2025-07-20T00:30:27.1903136Z Turborepo now collects completely anonymous telemetry regarding usage.
2025-07-20T00:30:27.1904105Z This information is used to shape the Turborepo roadmap and prioritize features.
2025-07-20T00:30:27.1905498Z You can learn more, including how to opt-out if you'd not like to participate in this anonymous program, by visiting the following URL:
2025-07-20T00:30:27.1906488Z https://turbo.build/repo/docs/telemetry
2025-07-20T00:30:27.1906699Z 
2025-07-20T00:30:27.2474825Z • Packages in scope: @cloudexpress/api, @cloudexpress/auth, @cloudexpress/builder, @cloudexpress/services-api, @cloudexpress/web-ui, @cygni/cli, @cygni/sdk, cygni-nextjs-starter
2025-07-20T00:30:27.2476219Z • Running test in 8 packages
2025-07-20T00:30:27.2476683Z • Remote caching disabled
2025-07-20T00:30:28.3729528Z ##[group]@cloudexpress/api:build
2025-07-20T00:30:28.3789902Z cache miss, executing d7d57639bfc623a5
2025-07-20T00:30:28.3790628Z 
2025-07-20T00:30:28.3791334Z > @cloudexpress/api@1.0.0 build /home/runner/work/Cygni/Cygni/packages/api
2025-07-20T00:30:28.3792273Z > echo 'Skipping build for packages/api - using services/api instead'
2025-07-20T00:30:28.3792704Z 
2025-07-20T00:30:28.3793076Z Skipping build for packages/api - using services/api instead
2025-07-20T00:30:28.3794193Z ##[endgroup]
2025-07-20T00:30:30.2256436Z ##[group]@cloudexpress/api:test
2025-07-20T00:30:30.2289806Z cache miss, executing 65717c5af65827f0
2025-07-20T00:30:30.2290153Z 
2025-07-20T00:30:30.2290610Z > @cloudexpress/api@1.0.0 test /home/runner/work/Cygni/Cygni/packages/api
2025-07-20T00:30:30.2291458Z > echo 'Skipping tests for packages/api - using services/api instead'
2025-07-20T00:30:30.2292052Z 
2025-07-20T00:30:30.2292577Z Skipping tests for packages/api - using services/api instead
2025-07-20T00:30:30.2293563Z ##[endgroup]
2025-07-20T00:30:34.0161337Z ##[group]@cloudexpress/auth:build
2025-07-20T00:30:34.0174390Z cache miss, executing b67affc02e0960ce
2025-07-20T00:30:34.0175112Z 
2025-07-20T00:30:34.0175761Z > @cloudexpress/auth@0.1.0 build /home/runner/work/Cygni/Cygni/services/auth
2025-07-20T00:30:34.0176537Z > tsc
2025-07-20T00:30:34.0176834Z 
2025-07-20T00:30:34.0177456Z ##[endgroup]
2025-07-20T00:30:34.7183937Z ##[group]@cygni/sdk:build
2025-07-20T00:30:34.7184580Z cache miss, executing 7c13eef4e550ea9c
2025-07-20T00:30:34.7185206Z 
2025-07-20T00:30:34.7185604Z > @cygni/sdk@0.1.0 build /home/runner/work/Cygni/Cygni/packages/sdk
2025-07-20T00:30:34.7186092Z > tsc
2025-07-20T00:30:34.7186242Z 
2025-07-20T00:30:34.7186567Z ##[endgroup]
2025-07-20T00:30:35.1377292Z [;31m@cloudexpress/builder:build[;0m
2025-07-20T00:30:35.1378629Z cache miss, executing 1c027b4cae1c2aa2
2025-07-20T00:30:35.1379492Z 
2025-07-20T00:30:35.1380216Z > @cloudexpress/builder@0.1.0 build /home/runner/work/Cygni/Cygni/services/builder
2025-07-20T00:30:35.1381142Z > tsc
2025-07-20T00:30:35.1381502Z 
2025-07-20T00:30:35.1405095Z ##[error]src/builder.test.ts(1,1): error TS2582: Cannot find name 'describe'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha`.
2025-07-20T00:30:35.1421896Z ##[error]src/builder.test.ts(2,3): error TS2582: Cannot find name 'it'. Do you need to install type definitions for a test runner? Try `npm i --save-dev @types/jest` or `npm i --save-dev @types/mocha`.
2025-07-20T00:30:35.1425147Z ##[error]src/builder.test.ts(3,5): error TS2304: Cannot find name 'expect'.
2025-07-20T00:30:35.1426725Z  ELIFECYCLE  Command failed with exit code 1.
2025-07-20T00:30:35.1428220Z [ERROR] command finished with error: command (/home/runner/work/Cygni/Cygni/services/builder) /home/runner/setup-pnpm/node_modules/.bin/pnpm run build exited (1)
2025-07-20T00:30:35.1462361Z ##[group]cygni-nextjs-starter:build
2025-07-20T00:30:35.1463077Z cache miss, executing 574eded4be020d8b
2025-07-20T00:30:35.1463766Z ##[endgroup]
2025-07-20T00:30:35.1470048Z ##[group]@cloudexpress/auth:test
2025-07-20T00:30:35.1471036Z cache miss, executing efa40a2d72fc604b
2025-07-20T00:30:35.1471680Z ##[endgroup]
2025-07-20T00:30:35.1477978Z ##[group]@cygni/sdk:test
2025-07-20T00:30:35.1478454Z cache miss, executing 70edf3f992f51596
2025-07-20T00:30:35.1480119Z ##[endgroup]
2025-07-20T00:30:35.1735861Z ##[group]@cloudexpress/services-api:build
2025-07-20T00:30:35.1737525Z cache miss, executing 0df342134276763b
2025-07-20T00:30:35.1737848Z 
2025-07-20T00:30:35.1738365Z > @cloudexpress/services-api@0.1.0 build /home/runner/work/Cygni/Cygni/services/api
2025-07-20T00:30:35.1744855Z > tsc
2025-07-20T00:30:35.1745019Z 
2025-07-20T00:30:35.1745378Z ##[endgroup]
2025-07-20T00:30:35.1846573Z ##[group]@cygni/cli:build
2025-07-20T00:30:35.1850899Z cache miss, executing 689109052fca61f6
2025-07-20T00:30:35.1851205Z 
2025-07-20T00:30:35.1851603Z > @cygni/cli@0.1.0 build /home/runner/work/Cygni/Cygni/packages/cli
2025-07-20T00:30:35.1852210Z > tsc && chmod +x dist/index.js
2025-07-20T00:30:35.1852466Z 
2025-07-20T00:30:35.1852816Z ##[endgroup]
2025-07-20T00:30:35.1855666Z ##[group]@cloudexpress/web-ui:build
2025-07-20T00:30:35.1856195Z cache miss, executing 228955e8942f1de9
2025-07-20T00:30:35.1856499Z 
2025-07-20T00:30:35.1856984Z > @cloudexpress/web-ui@0.1.0 build /home/runner/work/Cygni/Cygni/packages/web-ui
2025-07-20T00:30:35.1857608Z > next build
2025-07-20T00:30:35.1857783Z 
2025-07-20T00:30:35.1858250Z  ⚠ Invalid next.config.js options detected: 
2025-07-20T00:30:35.1859157Z  ⚠     Unrecognized key(s) in object: 'serverActions' at "experimental"
2025-07-20T00:30:35.1860058Z  ⚠ See more info here: https://nextjs.org/docs/messages/invalid-next-config
2025-07-20T00:30:35.1861262Z  ⚠ Server Actions are available by default now, `experimental.serverActions` option can be safely removed.
2025-07-20T00:30:35.1862860Z ⚠ No build cache found. Please configure build caching for faster rebuilds. Read more: https://nextjs.org/docs/messages/no-cache
2025-07-20T00:30:35.1864074Z Attention: Next.js now collects completely anonymous telemetry regarding usage.
2025-07-20T00:30:35.1865008Z This information is used to shape Next.js' roadmap and prioritize features.
2025-07-20T00:30:35.1866287Z You can learn more, including how to opt-out if you'd not like to participate in this anonymous program, by visiting the following URL:
2025-07-20T00:30:35.1867211Z https://nextjs.org/telemetry
2025-07-20T00:30:35.1867456Z 
2025-07-20T00:30:35.1867921Z    ▲ Next.js 14.0.0
2025-07-20T00:30:35.1868114Z 
2025-07-20T00:30:35.1868330Z    Creating an optimized production build ...
2025-07-20T00:30:35.1869180Z ##[endgroup]
2025-07-20T00:30:35.1889981Z ##[error]@cloudexpress/builder#build: command (/home/runner/work/Cygni/Cygni/services/builder) /home/runner/setup-pnpm/node_modules/.bin/pnpm run build exited (1)
2025-07-20T00:30:35.1891917Z 
2025-07-20T00:30:35.1892139Z  Tasks:    4 successful, 11 total
2025-07-20T00:30:35.1892562Z Cached:    0 cached, 11 total
2025-07-20T00:30:35.1892934Z   Time:    7.992s 
2025-07-20T00:30:35.1893354Z Failed:    @cloudexpress/builder#build
2025-07-20T00:30:35.1893634Z 
2025-07-20T00:30:35.1932037Z  ERROR  run failed: command  exited (1)
2025-07-20T00:30:35.2744013Z  ELIFECYCLE  Test failed. See above for more details.
2025-07-20T00:30:35.2932331Z Tests failed. Running individual package tests...
2025-07-20T00:30:35.7605808Z Scope: 8 of 9 workspace projects
2025-07-20T00:30:35.7634610Z packages/api test$ echo 'Skipping tests for packages/api - using services/api instead'
2025-07-20T00:30:35.7641415Z packages/cli test$ vitest
2025-07-20T00:30:35.7644556Z packages/sdk test$ jest
2025-07-20T00:30:35.7648104Z services/api test$ vitest
2025-07-20T00:30:35.7831309Z packages/api test: Skipping tests for packages/api - using services/api instead
2025-07-20T00:30:35.7865936Z packages/api test: Done
2025-07-20T00:30:35.8037220Z services/auth test$ vitest
2025-07-20T00:30:36.2746001Z packages/cli test: [33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
2025-07-20T00:30:36.2900395Z services/auth test: [7m[1m[36m RUN [39m[22m[27m [36mv0.34.6[39m [90m/home/runner/work/Cygni/Cygni/services/auth[39m
2025-07-20T00:30:36.2953862Z services/api test: [7m[1m[36m RUN [39m[22m[27m [36mv0.34.6[39m [90m/home/runner/work/Cygni/Cygni/services/api[39m
2025-07-20T00:30:36.3225516Z packages/cli test: [7m[1m[36m RUN [39m[22m[27m [36mv0.34.6[39m [90m/home/runner/work/Cygni/Cygni/packages/cli[39m
2025-07-20T00:30:37.0899375Z services/auth test:  [32m✓[39m src/auth.test.ts [2m ([22m[2m1 test[22m[2m)[22m[90m 5[2mms[22m[39m
2025-07-20T00:30:37.1056397Z services/auth test: [2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
2025-07-20T00:30:37.1058137Z services/auth test: [2m      Tests [22m [1m[32m1 passed[39m[22m[90m (1)[39m
2025-07-20T00:30:37.1062489Z services/auth test: [2m   Start at [22m 00:30:36
2025-07-20T00:30:37.1067237Z services/auth test: [2m   Duration [22m 813ms[2m (transform 79ms, setup 0ms, collect 59ms, tests 5ms, environment 0ms, prepare 143ms)[22m
2025-07-20T00:30:37.1331854Z services/api test:  [32m✓[39m src/health.test.ts [2m ([22m[2m1 test[22m[2m)[22m[90m 5[2mms[22m[39m
2025-07-20T00:30:37.1349160Z services/auth test: Done
2025-07-20T00:30:37.1349590Z services/builder test$ vitest
2025-07-20T00:30:37.1493053Z services/api test: [2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
2025-07-20T00:30:37.1496459Z services/api test: [2m      Tests [22m [1m[32m1 passed[39m[22m[90m (1)[39m
2025-07-20T00:30:37.1554195Z services/api test: [2m   Start at [22m 00:30:36
2025-07-20T00:30:37.1556087Z services/api test: [2m   Duration [22m 853ms[2m (transform 75ms, setup 0ms, collect 64ms, tests 5ms, environment 0ms, prepare 213ms)[22m
2025-07-20T00:30:37.1993128Z services/api test: Done
2025-07-20T00:30:37.4130570Z packages/cli test:  [32m✓[39m src/tests/framework-detector.test.ts [2m ([22m[2m12 tests[22m[2m)[22m[90m 17[2mms[22m[39m
2025-07-20T00:30:37.4635094Z packages/cli test: [90mstdout[2m | src/tests/builder.test.ts[2m > [22m[2mBuilder[2m > [22m[2mbuildProject[2m > [22m[2mshould auto-detect framework when not specified[22m[39m
2025-07-20T00:30:37.4636657Z packages/cli test: Detected framework: react
2025-07-20T00:30:37.4638487Z packages/cli test: [90mstdout[2m | src/tests/builder.test.ts[2m > [22m[2mBuilder[2m > [22m[2mbuildProject[2m > [22m[2mshould run pre-build commands when specified[22m[39m
2025-07-20T00:30:37.4640480Z packages/cli test: Running build command...
2025-07-20T00:30:37.4663353Z packages/cli test:  [32m✓[39m src/tests/builder.test.ts [2m ([22m[2m7 tests[22m[2m)[22m[90m 19[2mms[22m[39m
2025-07-20T00:30:37.5077610Z packages/sdk test: PASS src/sdk.test.ts
2025-07-20T00:30:37.5085353Z packages/sdk test:   SDK
2025-07-20T00:30:37.5140479Z packages/sdk test:     ✓ should pass basic test (5 ms)
2025-07-20T00:30:37.5141375Z packages/sdk test: Test Suites: 1 passed, 1 total
2025-07-20T00:30:37.5142179Z packages/sdk test: Tests:       1 passed, 1 total
2025-07-20T00:30:37.5142934Z packages/sdk test: Snapshots:   0 total
2025-07-20T00:30:37.5143645Z packages/sdk test: Time:        0.923 s
2025-07-20T00:30:37.5144316Z packages/sdk test: Ran all test suites.
2025-07-20T00:30:37.5518075Z packages/sdk test: Done
2025-07-20T00:30:37.6034550Z services/builder test: [7m[1m[36m RUN [39m[22m[27m [36mv0.34.6[39m [90m/home/runner/work/Cygni/Cygni/services/builder[39m
2025-07-20T00:30:37.7203841Z packages/cli test:  [33m❯[39m src/tests/deploy-helpers.test.ts [2m ([22m[2m18 tests[22m [2m|[22m [31m1 failed[39m[2m)[22m[90m 48[2mms[22m[39m
2025-07-20T00:30:37.7240800Z packages/cli test: [31m   [33m❯[31m src/tests/deploy-helpers.test.ts[2m > [22mDeploy Helpers[2m > [22mcheckBuildCache[2m > [22mshould calculate dockerfile hash when provided[39m
2025-07-20T00:30:37.7242903Z packages/cli test: [31m     → expected "spy" to be called with arguments: [ '/builds/cache', …(1) ]
2025-07-20T00:30:37.7243846Z packages/cli test: Received: 
2025-07-20T00:30:37.7244450Z packages/cli test: Number of calls: 0
2025-07-20T00:30:37.7245123Z packages/cli test: [39m
2025-07-20T00:30:37.8429275Z packages/cli test:  [32m✓[39m src/dummy.test.ts [2m ([22m[2m1 test[22m[2m)[22m[90m 8[2mms[22m[39m
2025-07-20T00:30:37.8533215Z packages/cli test: [31m⎯⎯⎯⎯⎯⎯⎯[1m[7m Failed Tests 1 [27m[22m⎯⎯⎯⎯⎯⎯⎯[39m
2025-07-20T00:30:37.8590652Z packages/cli test: [31m[1m[7m FAIL [27m[22m[39m src/tests/deploy-helpers.test.ts[2m > [22mDeploy Helpers[2m > [22mcheckBuildCache[2m > [22mshould calculate dockerfile hash when provided
2025-07-20T00:30:37.8648660Z packages/cli test: [31m[1mAssertionError[22m: expected "spy" to be called with arguments: [ '/builds/cache', …(1) ]
2025-07-20T00:30:37.8649995Z packages/cli test: Received: 
2025-07-20T00:30:37.8651448Z packages/cli test: Number of calls: 0
2025-07-20T00:30:37.8656209Z packages/cli test: [39m
2025-07-20T00:30:37.8663936Z packages/cli test: [36m [2m❯[22m src/tests/deploy-helpers.test.ts:[2m165:27[22m[39m
2025-07-20T00:30:37.8719222Z packages/cli test:     [90m163| [39m      await checkBuildCache("abc123", "Dockerfile");
2025-07-20T00:30:37.8722554Z packages/cli test:     [90m164| [39m
2025-07-20T00:30:37.8725993Z packages/cli test:     [90m165| [39m      expect(mockApi.get).toHaveBeenCalledWith("/builds/cache", {
2025-07-20T00:30:37.8733971Z packages/cli test:     [90m   | [39m                          [31m^[39m
2025-07-20T00:30:37.8759994Z packages/cli test:     [90m166| [39m        params: {
2025-07-20T00:30:37.8760948Z packages/cli test:     [90m167| [39m          gitSha: "abc123",
2025-07-20T00:30:37.8761982Z packages/cli test: [31m[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯[22m[39m
2025-07-20T00:30:37.8787047Z packages/cli test: [2m Test Files [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m3 passed[39m[22m[90m (4)[39m
2025-07-20T00:30:37.8789151Z packages/cli test: [2m      Tests [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m37 passed[39m[22m[90m (38)[39m
2025-07-20T00:30:37.8790496Z packages/cli test: [2m   Start at [22m 00:30:36
2025-07-20T00:30:37.8792509Z packages/cli test: [2m   Duration [22m 1.53s[2m (transform 587ms, setup 0ms, collect 1.18s, tests 92ms, environment 1ms, prepare 836ms)[22m
2025-07-20T00:30:37.9152737Z packages/cli test: Failed
2025-07-20T00:30:37.9170960Z /home/runner/work/Cygni/Cygni/packages/cli:
2025-07-20T00:30:37.9176725Z  ERR_PNPM_RECURSIVE_RUN_FIRST_FAIL  @cygni/cli@0.1.0 test: `vitest`
2025-07-20T00:30:37.9177781Z Exit status 1
2025-07-20T00:30:37.9390912Z ##[error]Process completed with exit code 1.
